<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: 'zh-CN' }}">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% if page.title %}{{ page.title | escape }} | {% endif %}{{ site.title | escape }}</title>
  <meta name="description" content="{{ page.excerpt | default: site.description | strip_html | normalize_whitespace | truncate: 160 | escape }}">
  <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
</head>

<body>
  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <header class="top-header">
    <div class="header-content">
      <div class="logo-section">
        <a href="/" class="logo">
          <span class="logo-icon">ğŸ“</span>
          <span class="logo-text">{{ site.title | escape }}</span>
        </a>
      </div>

      <nav class="top-nav">
        <a href="/" class="nav-item">é¦–é¡µ</a>
        <a href="/abroad" class="nav-item">å‡ºå›½ç•™å­¦</a>
      </nav>

      <div class="header-right">
        <input type="text" class="search-box" placeholder="Search">
        <a href="https://github.com/ouc-feiyue/feiyue-ouc" class="github-link" target="_blank">GitHub</a>
      </div>
    </div>
  </header>

  <div class="site-wrapper">
    <!-- å·¦ä¾§èœå• -->
    <aside class="sidebar-nav">
      <nav class="sidebar-menu">
        <a href="/" class="menu-item">é¦–é¡µ</a>
        <a href="#about" class="menu-item">å…³äº</a>
        <a href="#links" class="menu-item">å‹é“¾</a>
        <a href="#glossary" class="menu-item">åè¯è§£é‡Š</a>
        <a href="#faq" class="menu-item">Q & A</a>
      </nav>
    </aside>

    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <div class="main-content">
      <main class="page-content">
        {{ content }}
      </main>
    </div>

    <!-- å³ä¾§ç›®å½• -->
    <aside class="sidebar-toc">
      <div class="toc-title" id="toc-title">æœ¬é¡µå¯¼èˆª</div>
      <nav class="toc-nav" id="toc-nav">
        <!-- è‡ªåŠ¨ç”Ÿæˆçš„ç›®å½• -->
      </nav>
    </aside>

    <script>
      // è‡ªåŠ¨ç”Ÿæˆé¡µé¢ç›®å½•å¯¼èˆªæˆ–æ˜¾ç¤ºç« èŠ‚å¯¼èˆª
      document.addEventListener('DOMContentLoaded', function() {
        const tocNav = document.getElementById('toc-nav');
        const tocTitle = document.getElementById('toc-title');
        const currentPath = window.location.pathname;

        // å‡ºå›½ç•™å­¦ç« èŠ‚å¯¼èˆª
        const abroadChapters = [
          { title: '01. GPA ä¸æ ‡åŒ–è€ƒè¯•', url: '/abroad/gpa-exam' },
          { title: '02. èƒŒæ™¯ç»å†', url: '/abroad/background' },
          { title: '03. æ¨èä¿¡', url: '/abroad/recommendation-letter' },
          { title: '04. é€‰æ ¡å®šä½', url: '/abroad/school-selection' },
          { title: '05. å¥—ç£', url: '/abroad/reaching-out' },
          { title: '06. ç”³è¯·æ–‡ä¹¦', url: '/abroad/application-essay' },
          { title: '07. ç”³è¯·ææ–™æ¸…å•', url: '/abroad/materials' },
          { title: '08. ç½‘ç”³', url: '/abroad/online-application' },
          { title: '09. ç”³è¯·æ—¶é—´è§„åˆ’', url: '/abroad/timeline' },
          { title: '10. å¸¸è§é—®é¢˜', url: '/abroad/faq' },
          { title: '11. å…³é”®æˆåŠŸè¦ç´ ', url: '/abroad/key-success' },
          { title: '12. èµ„æºæ¨è', url: '/abroad/resources' }
        ];

        // æ£€æŸ¥æ˜¯å¦åœ¨å‡ºå›½ç•™å­¦ç›¸å…³é¡µé¢
        if (currentPath.startsWith('/abroad')) {
          tocTitle.textContent = 'å‡ºå›½ç•™å­¦ç« èŠ‚';

          abroadChapters.forEach((chapter) => {
            const link = document.createElement('a');
            link.href = chapter.url;
            link.className = 'toc-item';
            link.textContent = chapter.title;

            // æ ‡è®°å½“å‰ç« èŠ‚
            if (currentPath === chapter.url || currentPath === chapter.url + '/') {
              link.style.color = '#667eea';
              link.style.borderLeftColor = '#667eea';
            }

            tocNav.appendChild(link);
          });
        } else {
          // è‡ªåŠ¨ç”Ÿæˆé¡µé¢å†…å®¹çš„ç›®å½•
          const headings = document.querySelectorAll('.page-content h2, .page-content h3');

          if (headings.length === 0) return;

          headings.forEach((heading, index) => {
            const id = heading.id || `heading-${index}`;
            heading.id = id;

            const link = document.createElement('a');
            link.href = `#${id}`;
            link.className = `toc-item ${heading.tagName.toLowerCase()}`;
            link.textContent = heading.textContent;

            tocNav.appendChild(link);
          });
        }
      });
    </script>
  </div>

  <!-- Footer -->
  <footer class="site-footer">
    <div class="footer-content">
      <p>&copy; 2024 {{ site.title }}. MIT License.</p>
    </div>
  </footer>
</body>

</html>
